!style_blue{'''The Edit BNI Global Configuration fixture allows you to modify the VCP global configuration values that are manually maintained in the VCP management server UI.'''}

!style_blue{'''!-ConnectVCPManagementServer-!'''}

!style_red{'''Input Column Descriptions'''}

!style_green{'''wsdl - The wsdl end point to which the connection needs to be established'''}
!style_green{'''version - The actual "major" bni version for wsdl against which the test needs to be performed. wsdl schemas are "version" dependent so the proper version must be used'''}
!style_green{'''Currently supported version values are 2.4 (production version) and 3.9 (new release pending deployment to production)'''}

!style_red {'''Output Column Descriptions'''}

!style_green{'''isSuccessful - turns true if the connection is successful and false otherwise'''}

!style_blue{'''The View BNI Global Configuration fixture allows you to view the VCP global configuration values that are normally maintained in the VCP management server UI.'''}

!style_red{'''Input Column Descriptions'''}

!style_green{'''set - The set name to which the property belongs'''}
!style_green{'''name - The name of the global configuration property to be viewed / modified'''}
!style_green{'''new value - The new value to be updated in bni ( Not needed for viewing bni configuration)'''}

!style_red {'''Output Column Descriptions'''}

!style_green {'''get value - to get the current value from bni'''}
!style_green {'''add - to add the new value to the new configuration xml'''}
!style_green {'''update - update bni server with new configuration xml and returns the status of modification'''} 
 
!style_blue{'''1. Import package - common to all wiki pages'''}.

|Import                                      |
|com.comcast.apps.api.bni.globalconfiguration|
|com.comcast.core                            |

!********> Variables
!define bar {|}
*************!

!style_blue{'''2. The !-ConnectVCPManagementServer-! fixture establishes the connection with the BNI web services and returns whether the connection is successful .'''}

!|ConnectVCPManagementServerForGlobalConfig                                       |
|wsdl                                                      |version|isSuccessful()|
|http://10.255.185.140:8080/config/configExportService?wsdl|2.4    |              |
|http://10.255.185.140:8080/config/configImportService?wsdl|2.4    |              |
#|http://10.253.179.48:8080/topology-mgmt/device?wsdl |3.8    |              |

!style_blue{'''3. The following fixture will return the global configuration values for net.beaumaris.dw.client.enable and net.beaumaris.common.billing.provider.'''}

!|ViewBNIGlobalConfiguration                         |
|set|name                                 |get value?|
|dw |net.beaumaris.dw.client.enable       |          |
|big|net.beaumaris.common.billing.provider|          |
     

!style_blue{'''4. The following fixture will build the xml to be passed to the web service that  updates the global configuration values. You can have more than one value to change multiple  values in the file.'''}

!|EditBNIGlobalConfiguration                                        |
|set    |name                                 |new value|add to xml?|
|dw     |net.beaumaris.dw.client.enable       |true     |added      |
|dw     |net.beaumaris.dw.maxmessages.limit   |100      |added      |
|billing|net.beaumaris.common.billing.provider|CEMP     |added      |

!style_blue{'''5. Wait for 30 seconds'''}

!|AddDelay                  |
|time|delay?                |
|30  |delayed for 30 seconds|


!style_blue{'''6. The following fixture will send the xml file to the BNI Global Configuration SOAP service and update the VCP BNI database.'''}

!|EditBNIGlobalConfiguration|
|update?                    |
|success                    |

!style_blue{'''7. Wait for 45 seconds'''}

!|AddDelay                  |
|time|delay?                |
|45  |delayed for 45 seconds|


!style_blue{'''8. The following fixture is used to verify that the configuration has been updated.'''}

!|ViewBNIGlobalConfiguration                  |
|set|name                          |get value?|
|dw |net.beaumaris.dw.client.enable|true      |

!style_blue{'''9. The following fixture has been added for troubleshooting instances where the global configuration value is not updated.'''}

!|RunCommand|
|host|username|password|connect?|
|10.255.185.140|bninet|password|connected|

!style_blue{''' The command column allows you to enter command(s) at the command prompt. Console output will be shown in the output column.'''}
!style_blue{''' It is used to check whether the changes are updated in the MAN server'''}

!|RunCommand|
|command| output?|
|cat  jbossesb/server/default/log/server.log ${bar} grep =true ${bar} tail -1||
|cat  jbossesb/server/default/log/server.log ${bar} grep CEMP ${bar} tail -1||
|cat  jbossesb/server/default/log/server.log ${bar} grep =100 ${bar} tail -1||

!style_blue{'''10. Return the dw client enable fixture back to  the original value.'''}

!|EditBNIGlobalConfiguration                             |
|set|name                          |new value|add to xml?|
|dw |net.beaumaris.dw.client.enable|false    |added      |


!style_blue{'''11. Wait for 30 seconds'''}

!|AddDelay                  |
|time|delay?                |
|30  |delayed for 30 seconds|

!style_blue{'''12. The following fixture will send the xml file to the BNI Global Configuration SOAP service and update the VCP BNI database.'''}

!|EditBNIGlobalConfiguration|
|update?                    |
|success                    |

!style_blue{'''13. Wait for 45 seconds'''}

!|AddDelay                  |
|time|delay?                |
|45  |delayed for 45 seconds|

!style_blue{'''14. The following fixture is used to verify that the configuration has been updated.'''}

!|ViewBNIGlobalConfiguration                  |
|set|name                          |get value?|
|dw |net.beaumaris.dw.client.enable|false     |


!|RunCommand|
|host|username|password|connect?|
|10.255.185.140|bninet|password|connected|

!style_blue{''' The command column allows you to enter command(s) at the command prompt. Console output will be shown in the output column.'''}
!style_blue{''' It is used to check whether the changes are updated in the MAN server'''}

!|RunCommand|
|command| output?|
|cat  jbossesb/server/default/log/server.log ${bar} grep =false ${bar} tail -1||

----